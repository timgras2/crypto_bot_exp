# =============================================================================
# CRYPTO TRADING BOT CONFIGURATION
# =============================================================================

# Bitvavo API Configuration (Required)
BITVAVO_API_KEY=your_api_key_here
BITVAVO_API_SECRET=your_api_secret_here
BITVAVO_BASE_URL=https://api.bitvavo.com/v2

# =============================================================================
# CORE TRADING SETTINGS
# =============================================================================

# ⚠️ SAFETY: Start with small amounts for testing!
MIN_PROFIT_PCT=5.0          # Stop loss percentage for new listings (5% loss = sell)
TRAILING_PCT=3.0            # Trailing stop percentage (lock in profits as price rises)
MAX_TRADE_AMOUNT=5.0        # EUR per trade - START SMALL for testing!
CHECK_INTERVAL=10           # Seconds between market scans
MAX_RETRIES=3               # API retry attempts
RETRY_DELAY=5               # Seconds between retries
RATE_LIMIT=300              # API requests per minute
API_TIMEOUT=30              # API timeout in seconds
OPERATOR_ID=1001            # Required by Bitvavo API for order identification

# =============================================================================
# 🛡️ ASSET PROTECTION SYSTEM (Advanced Portfolio Management)
# =============================================================================

# Master Controls
ASSET_PROTECTION_ENABLED=false          # Master toggle - set to 'true' to enable
PROTECTED_ASSETS=BTC-EUR,ETH-EUR        # Comma-separated list of assets to protect
MAX_PROTECTION_BUDGET=100.0             # Maximum EUR for DCA operations per day

# 📊 CRYPTO-OPTIMIZED LEVELS (Designed for crypto volatility)
# Choose configuration based on your risk tolerance:

# CONSERVATIVE (Mature assets: BTC, ETH) - Recommended for beginners
DCA_ENABLED=true
DCA_LEVELS=15:0.3,25:0.4,40:0.3         # DCA at -15%, -25%, -40% drops
SWING_TRADING_ENABLED=false              # Start with DCA only
SWING_LEVELS=12:sell:0.15,18:sell:0.20,35:rebuy:0.40,50:rebuy:0.60
LOSS_CIRCUIT_BREAKER_PCT=25.0            # Stop buying at -25% loss

# AGGRESSIVE (Higher volatility tolerance) - For experienced users
# DCA_LEVELS=10:0.3,20:0.4,35:0.3        # More frequent DCA
# SWING_LEVELS=8:sell:0.15,15:sell:0.20,30:rebuy:0.40,45:rebuy:0.60
# LOSS_CIRCUIT_BREAKER_PCT=20.0          # Earlier circuit breaker

# ALTCOIN (Very high volatility) - For altcoin portfolios
# DCA_LEVELS=20:0.3,35:0.4,55:0.3        # Wider DCA levels
# SWING_LEVELS=20:sell:0.15,30:sell:0.20,50:rebuy:0.40,70:rebuy:0.60
# LOSS_CIRCUIT_BREAKER_PCT=35.0          # Higher tolerance

# =============================================================================
# 🚨 INTELLIGENT SAFETY FEATURES (Upgrade Guide Implementation)
# =============================================================================

# Position Size Controls (prevents over-exposure)
MAX_POSITION_MULTIPLIER=2.0               # Maximum 2x original position size
POSITION_SIZE_CHECK_ENABLED=true          # Enable position size monitoring
CIRCUIT_BREAKER_ENABLED=true              # Enable loss circuit breaker

# Smart DCA Timing (prevents "falling knife" purchases)
DIRECTIONAL_DCA_ENABLED=true              # Enable momentum-based DCA timing
DCA_MOMENTUM_HOURS=1                      # Hours to analyze price momentum
DCA_FALLING_MULTIPLIER=0.5                # Reduce DCA when price falling through level
DCA_BOUNCING_MULTIPLIER=1.5               # Increase DCA when price bouncing off level
DCA_MOMENTUM_THRESHOLD=0.5                # Minimum 0.5% momentum to trigger logic

# Swing Trading (Optional - Advanced users)
SWING_CASH_RESERVE_PCT=75.0               # Keep 75% of swing sale proceeds for rebuying
SWING_TRAILING_STOP_ENABLED=true          # Trail stops upward during recovery

# Recovery Rebuy System (Solves the "missed opportunity" problem)
RECOVERY_REBUY_ENABLED=true               # Enable recovery rebuys on bounces from any drop
MIN_RECOVERY_THRESHOLD_PCT=15.0           # Minimum drop required to track for recovery (15%)
RECOVERY_BOUNCE_PCT=8.0                   # Bounce % from low to trigger rebuy (8%)
RECOVERY_REBUY_ALLOCATION=0.3             # Use 30% of available cash reserves

# =============================================================================
# 📈 PROFIT MANAGEMENT
# =============================================================================

# Basic Profit Taking
PROFIT_TAKING_ENABLED=true               # Enable profit taking on gains
PROFIT_TAKING_LEVELS=25:0.25,50:0.5     # Sell 25% at +25%, 50% at +50% (crypto-adjusted)

# Enhanced Protection (Trailing Profits + Dynamic Buybacks)
ENHANCED_PROTECTION_ENABLED=true         # Enable advanced profit features
TRAILING_START_GAIN_PCT=12.0             # Start trailing after +12% gains (crypto-adjusted)
TRAILING_DISTANCE_PCT=8.0                # Trail 8% below highest price (crypto-adjusted)
TRAILING_INCREMENT_PCT=3.0               # Sell 3% of position per trigger (crypto-adjusted)

# Dynamic Buybacks
BUYBACK_TOLERANCE_PCT=5.0                # Buy back within 5% of sell price (crypto-adjusted)
MIN_TRADE_VALUE_EUR=20.0                 # Minimum EUR value per trade

# =============================================================================
# 🚀 RISK MANAGEMENT
# =============================================================================

# Daily Limits
MAX_DAILY_TRADES=10                      # Maximum trades per day per asset
EMERGENCY_STOP_LOSS_PCT=30.0             # Emergency stop loss (crypto-adjusted)

# Volatility-based Stop Loss
BASE_STOP_LOSS_PCT=18.0                  # Base stop loss percentage (crypto-adjusted)
VOLATILITY_WINDOW_HOURS=24               # Hours for volatility calculation
VOLATILITY_MULTIPLIER=1.5                # Volatility adjustment factor

# =============================================================================
# 📊 PORTFOLIO REBALANCING (Optional - Advanced)
# =============================================================================

REBALANCING_ENABLED=false                # Enable automatic rebalancing
REBALANCING_THRESHOLD_PCT=15.0           # Rebalance when allocation drifts >15% (crypto-adjusted)
TARGET_ALLOCATIONS=BTC-EUR:0.6,ETH-EUR:0.4  # Target allocation percentages

# =============================================================================
# 🎯 DIP BUYING FOR NEW LISTINGS (Optional)
# =============================================================================

DIP_BUY_ENABLED=false                    # Master toggle for post-sale dip buying
DIP_MONITORING_HOURS=48                  # Hours to monitor after profitable sale
DIP_COOLDOWN_HOURS=4                     # Hours between rebuys per asset
DIP_MAX_REBUYS_PER_ASSET=3               # Maximum rebuy attempts per asset
DIP_USE_MARKET_FILTER=false              # Enable BTC trend filtering
DIP_LEVELS=15:0.4,25:0.35,40:0.25       # Dip buy levels (crypto-adjusted)

# =============================================================================
# 💡 KEY IMPROVEMENTS IN THIS VERSION
# =============================================================================

# ✅ FIXED CONFLICTING STRATEGIES:
#    - Old: Swing sell at -10% AND DCA buy at -10% = amplified losses
#    - New: Coordinated levels that don't conflict

# ✅ SMART MOMENTUM ANALYSIS:
#    - Reduces DCA when falling through levels (avoid falling knives)  
#    - Increases DCA when bouncing off levels (catch recoveries)

# ✅ CRYPTO-APPROPRIATE VOLATILITY:
#    - Levels adjusted for crypto market reality (15-40% moves are normal)
#    - Higher circuit breaker thresholds (25-35% vs 15%)
#    - Wider swing levels (12-50% vs 5-30%)

# ✅ POSITION SIZE PROTECTION:
#    - Prevents excessive position growth from multiple strategies
#    - Circuit breaker stops buying during severe crashes

# ✅ ENHANCED SAFETY:
#    - Trend analysis delays rebuys during confirmed downtrends
#    - Multiple layers of risk management and position control

# ✅ RECOVERY REBUY SYSTEM:
#    - Solves "missed opportunity" problem (e.g., BTC drops to -27%, recovers before -30%)
#    - Tracks lowest price during any significant drop (>15%)
#    - Triggers rebuy on 8% bounce from the low (catches recoveries)
#    - Example: Drop to -27%, bounce +8% = recovery rebuy triggered
#    - Uses swing cash reserves, respects position limits